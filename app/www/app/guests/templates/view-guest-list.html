<ion-view class="light-bg" ng-init="initGuestListView()"
          style="background-color: #EEEEEE"
          view-title="Guest Lists"
          cache-view="false">
    <ion-content class="content-body">
        <div class="button-bar">
            <a class="button" ng-style="isActive('newGuests')"
               style="border: none;font-weight: bold;background-color: #EEEEEE"
               ng-click="setActive('newGuests')">New
                Guests</a>
            <a class="button" ng-style="isActive('checkedIn')"
               style="border: none;font-weight: bold;background-color: #EEEEEE"
               ng-click="setActive('checkedIn')">Checked-in</a>
        </div>

        <div class="list list-inset" ng-if="!fecthingData" ng-cloak style="background-color: #EEEEEE">
            <label class="item item-input" style="border-radius: 25px">
                <i class="icon ion-search placeholder-icon"></i>
                <input type="text" placeholder="Search Guests" ng-model="filter.query">
            </label>
        </div>
        <grey>
            <ion-refresher
                    pulling-text="Pull to refresh..."
                    on-refresh="doRefresh()">
            </ion-refresher>
            <ion-list can-swipe="'true'">
                <ion-item
                        collection-repeat="guestEntry in guestEntriesFiltered | filter:filter.query | orderBy: 'guest.lastName' "
                        class="item-thumbnail-left"
                        style="margin-left: 30px;margin-right: 30px;border-left: none;border-right: none;"
                        ui-sref="app.check_guest({guestId:guestEntry.guest.id, gliId:guestEntry.glist.id})">

                    <img ng-src="img/icons/user_01.png">

                    <h2 style="font-weight: bold"> {{guestEntry.guest.lastName}} {{guestEntry.guest.firstName}}</h2>

                    <p style="margin-top: 30px;">{{guestEntry.guest.plus + 1 -
                        guestEntry.plusBalance}} /
                        {{guestEntry.guest.plus + 1}}
                        Checked-in</p>
                    <ion-option-button class="button-info logo-bg"
                                       ng-click="subtractGuestCount(guestEntry)"
                                       style="color:white;">
                        -GUEST
                    </ion-option-button>
                    <ion-option-button class="button-info logo-bg"
                                       ng-click="addGuestCount(guestEntry)"
                                       style="color:white;background-color: #2CD6D6">
                        +GUEST
                    </ion-option-button>
                    <ion-option-button class="button-info logo-bg"
                                       ng-click="checkIn(guestEntry)" style="color:white;background-color: #2CD6D6">
                        <span ng-if="!checkinSpinnerOn && !isCheckinDisabled(guestEntry)">{{guestEntry.plus + isNotChecked(guestEntry)}}</span>
                        <span ng-if="!checkinSpinnerOn && isCheckinDisabled(guestEntry)">CHECKED IN</span>

                        <ion-spinner ng-if="checkinSpinnerOn"></ion-spinner>
                    </ion-option-button>
                </ion-item>
            </ion-list>
        </grey>
        <div style="margin-left:47%">
            <ion-spinner ng-if="fecthingData"></ion-spinner>
        </div>
    </ion-content>

</ion-view>